<!DOCTYPE HTML>
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>KSX - 个人博客</title>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<meta name="description" content="KSX - 个人博客" />
		<meta name="keywords" content="KSX,php,JS,JQuery,Web,Oracle,Git,GitHub,Jekyll,Bootstrap,个人博客,博客" />

	<link href="../../favicon.ico" rel="icon" type="image/x-icon" />
	<link href="https://fonts.googleapis.com/css?family=Crimson+Text:400,400i|Roboto+Mono" rel="stylesheet">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="../../css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="../../css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="../../css/bootstrap.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="../../css/magnific-popup.css">

	<!-- Theme style  -->
	<link rel="stylesheet" href="../../css/style.css">

	<!-- Modernizr JS -->
	<script src="../../js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->

	</head>
	<body>
		
	<div class="gtco-loader"></div>
	
	<div id="page">
	<nav class="gtco-nav" role="navigation">
		<div class="container">
			<div class="row">
				<div class="col-xs-2 text-left">
					<div id="gtco-logo"><a href="index.html">KSX<span>.</span></a></div>
				</div>
				<div class="col-xs-10 text-right menu-1">
					<ul>
						<li><a href="../../index.html" style="font-size:16px;font-weight: bold;">首页</a></li>
						<li class="active"><a href="../../archive.html" style="font-size:16px;font-weight: bold;">归档</a></li>
						<li><a href="../../category.html" style="font-size:16px;font-weight: bold;">分类</a></li>
						<li class="has-dropdown">
							<a style="font-size:16px;font-weight: bold;">API</a>
							<ul class="dropdown">
								<li><a href="http://itmyhome.com/git/" target="_blank">Git</a></li>
								<li><a href="http://itmyhome.com/progit/" target="_blank">Pro Git</a></li>
								<li><a href="http://itmyhome.com/jq/" target="_blank">JQuery</a></li>
								<li><a href="http://itmyhome.com/easyui/" target="_blank">EasyUI</a></li>
								<li><a href="http://itmyhome.com/bootstrap/" target="_blank">Bootstrap</a></li>
								<li><a href="http://itmyhome.com/markdown/" target="_blank">Markdown</a></li>
								<li><a href="http://itmyhome.com/front/" target="_blank">前端开发规范手册</a></li>
								<li><a href="http://itmyhome.com/js/" target="_blank">JavaScript</a></li>
								<li><a href="http://itmyhome.com/html/" target="_blank">HTML</a></li>
								<li><a href="http://itmyhome.com/css/" target="_blank">CSS</a></li>
								<li><a href="http://itmyhome.com/rgb/" target="_blank">RGB</a></li>
							</ul>
						</li>
						<li class="has-dropdown">
							<a style="font-size:16px;font-weight: bold;">PDF</a>
							<ul class="dropdown">
								<li><a href="http://itmyhome.com/progit-pdf/" target="_blank">Pro Git </a></li>
								<li><a href="http://itmyhome.com/the-definitive-guide-of-git-pdf/" target="_blank">Git权威指南</a></li>
								<li><a href="http://itmyhome.com/javascript-pdf/" target="_blank">JavaScript权威指南</a></li>
								<li><a href="http://itmyhome.com/jquery-in-action-pdf/" target="_blank">jQuery实战</a></li>
								<li><a href="http://itmyhome.com/mybatis-pdf/" target="_blank">MyBatis3用户指南</a></li>
								<li><a href="http://itmyhome.com/ibatis-pdf/" target="_blank">IBATIS2.0开发指南</a></li>
								<li><a href="http://itmyhome.com/html-pdf/" target="_blank">HTML精选属性</a></li>
								<li><a href="http://itmyhome.com/jdbc-pdf/" target="_blank">JDBC学习手册</a></li>
								<li><a href="http://itmyhome.com/programmer-job-hopping-pdf/" target="_blank">程序员跳槽全攻略</a></li>
								<li><a href="http://itmyhome.com/software-random-thoughts-pdf/" target="_blank">软件随想录</a></li>
							</ul>
						</li>
						<li><a href="http://blog.csdn.net/kesixin" target="_blank" style="font-size:16px;font-weight: bold;">CSDN</a></li>
						<li><a href="http://www.jianshu.com/u/ed95b64d8305" target="_blank" style="font-size:16px;font-weight: bold;">简书</a></li>
						<li><a href="../../history.html" style="font-size:16px;font-weight: bold;">历程</a></li>
						<li><a href="../../history.html" style="font-size:16px;font-weight: bold;">关于</a></li>
					</ul>
				</div>
			</div>
			
		</div>
	</nav>

	<header id="gtco-header" class="gtco-cover" role="banner" style="background-image:url(../../images/img_7.jpg);background-position:0px;" data-stellar-background-ratio="0.5">
		<div class="overlay"></div>
		<div class="container">
			<div class="row">
				<div class="col-md-7 text-left">
					<div class="display-t">
						<div class="display-tc animate-box" data-animate-effect="fadeInUp">
							<span class="date-post">2017-08-26</span>
							<h1 class="mb30"><a href="#">cropper.js 实现裁剪图片并上传(移动端)</a></h1>
						</div>
					</div>
				</div>
			</div>
		</div>
	</header>
	
	<div id="gtco-maine">
		<div class="container">
			<div class="row row-pb-md">
				<div class="col-md-12">
					<article class="mt-negative">
						<div class="text-left content-article">
							<div class="row">
								<div class="col-lg-8 cp-r animate-box">
									
<p>上一篇文章已经编写了PC端的裁剪图片案例，这次是涉及移动端的头像裁剪更换，类似于微信更换头像功能。。。</p>

<p><strong></strong><a href="http://download.csdn.net/download/kesixin/9951656" target="_blank">案例下载</a></p>

<p>思路跟PC端的案例是一样的，这里就不多说了。</p>

<p>将案例放到服务器上，如果出现上传失败可能是： <br>
1.提交处理服务url出错：main.js</p>



<pre class="prettyprint"><code class=" hljs javascript">$(document.body).on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'[data-method]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
      <span class="hljs-keyword">var</span> data = $(<span class="hljs-keyword">this</span>).data(),
          $target,
          result;

      <span class="hljs-keyword">if</span> (data.method) {
        data = $.extend({}, data); <span class="hljs-comment">// Clone a new one</span>

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> data.target !== <span class="hljs-string">'undefined'</span>) {
          $target = $(data.target);

          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> data.option === <span class="hljs-string">'undefined'</span>) {
            <span class="hljs-keyword">try</span> {
              data.option = <span class="hljs-built_in">JSON</span>.parse($target.val());
            } <span class="hljs-keyword">catch</span> (e) {
              console.log(e.message);
            }
          }
        }

        result = $image.cropper(data.method, data.option);

        <span class="hljs-keyword">if</span> (data.method === <span class="hljs-string">'getCroppedCanvas'</span>) {
<span class="hljs-comment">//          $('#getCroppedCanvasModal').modal().find('.modal-body').html(result);</span>
<span class="hljs-comment">//          alert(result.toDataURL('image/jpeg'));</span>
<span class="hljs-comment">//          $.post('/index.php/sdasdf',result.toDataURL('image/jpeg'),function(){},'json');</span>
            <span class="hljs-keyword">var</span> imgBase=result.toDataURL(<span class="hljs-string">'image/jpeg'</span>);
            <span class="hljs-keyword">if</span>(imgBase!=<span class="hljs-string">""</span>){
                <span class="hljs-keyword">var</span> data = {imgBase: imgBase};
                <span class="hljs-comment">//提交地址</span>
                $.post(<span class="hljs-string">'../mobile/upload.php'</span>, data, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(ret)</span> {</span>
                    <span class="hljs-keyword">if</span>(ret==<span class="hljs-string">'true'</span>){
                        alert(<span class="hljs-string">'上传成功'</span>);
                      }<span class="hljs-keyword">else</span>{
                        alert(<span class="hljs-string">'上传失败'</span>);
                      }
                }, <span class="hljs-string">'text'</span>);
            }
        }

        <span class="hljs-keyword">if</span> ($.isPlainObject(result) &amp;&amp; $target) {
          <span class="hljs-keyword">try</span> {
            $target.val(<span class="hljs-built_in">JSON</span>.stringify(result));
          } <span class="hljs-keyword">catch</span> (e) {
            console.log(e.message);
          }
        }

      }
    }).on(<span class="hljs-string">'keydown'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>

      <span class="hljs-keyword">switch</span> (e.which) {
        <span class="hljs-keyword">case</span> <span class="hljs-number">37</span>:
          e.preventDefault();
          $image.cropper(<span class="hljs-string">'move'</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
          <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> <span class="hljs-number">38</span>:
          e.preventDefault();
          $image.cropper(<span class="hljs-string">'move'</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>);
          <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> <span class="hljs-number">39</span>:
          e.preventDefault();
          $image.cropper(<span class="hljs-string">'move'</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
          <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> <span class="hljs-number">40</span>:
          e.preventDefault();
          $image.cropper(<span class="hljs-string">'move'</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
          <span class="hljs-keyword">break</span>;
      }

    });</code></pre>

<p>实现效果：</p>

<p><img src="http://upload-images.jianshu.io/upload_images/6673460-5ca3cd861ddadaec.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title="" class="img-responsive"></p>
								</div>
								<div class="col-lg-4 animate-box">
									<div class="gtco-highlight right">
										<h4>点点滴滴</h4>
										<p style="font-size:15px;">不因幸運而固步自封 不因厄運而一蹶不振 真正的強者 善於從順境中找到陰影 從逆境中找到光亮 時時校準自己前進的目標</p>
									</div>
								</div>
							</div>
													
						</div>
					</article>
				</div>
			</div>
		</div>
	</div>



	<footer id="gtco-footer" role="contentinfo" style="padding:0;">
		<div class="container">
			<div class="row copyright">
				<div class="col-md-12 text-center">
					<p>
						 <span style="font-size:16px;">©</span>2017 版权所有 ICP证：<a href="http://www.miitbeian.gov.cn/" target="_block" style="color:#666666">粤ICP备17112246号</a>
						<script type="text/javascript">
                            var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
                            document.write(unescape("%3Cspan id='cnzz_stat_icon_1264398044'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1264398044%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));
						</script>
					</p>
				</div>
			</div>

		</div>
	</footer>
	</div>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
	</div>
	
	<!-- jQuery -->
	<script src="../../js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="../../js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="../../js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="../../js/jquery.waypoints.min.js"></script>
	<!-- Stellar -->
	<script src="../../js/jquery.stellar.min.js"></script>
	<!-- Main -->
	<script src="../../js/main.js"></script>

	</body>
</html>

