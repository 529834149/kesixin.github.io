<!DOCTYPE HTML>
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>KSX - 个人博客</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Free HTML5 Website Template by GetTemplates.co" />
	<meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />

	<link href="../../favicon.ico" rel="icon" type="image/x-icon" />
	<link href="https://fonts.googleapis.com/css?family=Crimson+Text:400,400i|Roboto+Mono" rel="stylesheet">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="../../css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="../../css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="../../css/bootstrap.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="../../css/magnific-popup.css">

	<!-- Theme style  -->
	<link rel="stylesheet" href="../../css/style.css">

	<!-- Modernizr JS -->
	<script src="../../js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->

	</head>
	<body>
		
	<div class="gtco-loader"></div>
	
	<div id="page">
	<nav class="gtco-nav" role="navigation">
		<div class="container">
			<div class="row">
				<div class="col-xs-2 text-left">
					<div id="gtco-logo"><a href="index.html">KSX<span>.</span></a></div>
				</div>
				<div class="col-xs-10 text-right menu-1">
                  <ul>
                    <li><a href="../../index.html" style="font-size:14px;">首页</a></li>
                    <li><a href="../../category.html" style="font-size:14px;">分类</a></li>
                    <li class="has-dropdown">
                      <a style="font-size:14px;">API</a>
                      <ul class="dropdown">
                        <li><a href="" target="_blank">API docs</a></li>
                        <li><a href="" target="_blank">Git</a></li>
                        <li><a href="" target="_blank">Pro Git</a></li>
                        <li><a href="" target="_blank">JavaAPI</a></li>
                        <li><a href="" target="_blank">Hibernate</a></li>
                        <li><a href="" target="_blank">Spring</a></li>
                        <li><a href="" target="_blank">MyBatis</a></li>
                        <li><a href="" target="_blank">Activiti</a></li>
                        <li><a href="" target="_blank">JQuery</a></li>
                        <li><a href="" target="_blank">EasyUI</a></li>
                        <li><a href="" target="_blank">Bootstrap</a></li>
                        <li><a href="" target="_blank">Markdown</a></li>
                        <li><a href="" target="_blank">前端开发规范手册</a></li>
                        <li><a href="" target="_blank">JavaScript</a></li>
                        <li><a href="" target="_blank">HTML</a></li>
                        <li><a href="" target="_blank">CSS</a></li>
                        <li><a href="" target="_blank">RGB</a></li>
                      </ul>
                    </li>
                    <li class="has-dropdown">
                      <a style="font-size:14px;">PDF</a>
                      <ul class="dropdown">
                        <li><a href="" target="_blank">PDF Book</a></li>
                        <li><a href="" target="_blank">Pro Git </a></li>
                        <li><a href="" target="_blank">Git权威指南</a></li>
                        <li><a href="" target="_blank">JavaScript权威指南</a></li>
                        <li><a href="" target="_blank">jQuery实战</a></li>
                        <li><a href="" target="_blank">MyBatis3用户指南</a></li>
                        <li><a href="" target="_blank">IBATIS2.0开发指南</a></li>
                        <li><a href="" target="_blank">HTML精选属性</a></li>
                        <li><a href="" target="_blank">JDBC学习手册</a></li>
                        <li><a href="" target="_blank">程序员跳槽全攻略</a></li>
                        <li><a href="" target="_blank">Java程序员面试宝典</a></li>
                        <li><a href="" target="_blank">Java并发编程的艺术</a></li>
                        <li><a href="" target="_blank">软件随想录</a></li>
                        <li><a href="" target="_blank">Java面试题</a></li>
                      </ul>
                    </li>
                    <li><a href="http://blog.csdn.net/kesixin" target="_blank" style="font-size:14px;">CSDN</a></li>
                    <li><a href="http://www.jianshu.com/u/ed95b64d8305" target="_blank" style="font-size:14px;">简书</a></li>
                    <li><a style="font-size:14px;">历程</a></li>
                    <li><a style="font-size:14px;">关于</a></li>
                  </ul>
				</div>
			</div>
			
		</div>
	</nav>

	<header id="gtco-header" class="gtco-cover" role="banner" style="background-image:url(../../images/img_7.jpg);background-position:0px;" data-stellar-background-ratio="0.5">
		<div class="overlay"></div>
		<div class="container">
			<div class="row">
				<div class="col-md-7 text-left">
					<div class="display-t">
						<div class="display-tc animate-box" data-animate-effect="fadeInUp">
							<span class="date-post">2017-08-19</span>
							<h1 class="mb30"><a href="#">cropper.js 实现裁剪图片并上传(PC端)</a></h1>
						</div>
					</div>
				</div>
			</div>
		</div>
	</header>
	
	<div id="gtco-maine">
		<div class="container">
			<div class="row row-pb-md">
				<div class="col-md-12">
					<article class="mt-negative">
						<div class="text-left content-article">
							<div class="row">
								<div class="col-lg-8 cp-r animate-box">
<p>由于之前做项目的时候有需求是需要实现裁剪图片来做头像并上传到服务器，所以上网查询了很多资料，也试用了许多案例，发现cropper插件裁剪是比较完善的，所以结合之前的使用情况，编写了此案例。本案例是参考<a href="http://fengyuanchen.github.io/cropper/" target="_block">cropper站点</a>实例，进行修改简化。</p>

<p><strong></strong><a href="http://download.csdn.net/download/kesixin/9941451" target="_block">案例下载</a></p>



<h2 id="option相关参数说明">option相关参数说明：</h2>

<p><strong>viewMode 显示模式</strong> <br>
Type: Number <br>
Default: 0 <br>
Options: <br>
0: the crop box is just within the container    裁剪框只能在 1内移动 <br>
1: the crop box should be within the canvas   裁剪框 只能在  2图片内移动 <br>
2: the canvas should not be within the container  2图片 不全部铺满1 （即缩小时可以有一边出现空隙） <br>
3: the container should be within the canvas  2图片 全部铺满1 （即 再怎么缩小也不会出现空隙）</p>

<p><strong>dragMode  拖动模式</strong> <br>
Default: ‘crop’ <br>
Options: <br>
‘crop’: create a new crop box  当鼠标 点击一处时根据这个点重新生成一个 裁剪框 <br>
‘move’: move the canvas    可以拖动图片 <br>
‘none’: do nothing  图片就不能拖动了</p>

<p><strong>toggleDragModeOnDblclick：</strong>  默认true .是否允许 拖动模式 “crop” 跟“move” 的切换状态。。即当点下为crop 模式，如果未松开拖动这时就是“move”模式。放开后又为“crop”模式。</p>

<p><strong>preview：</strong> 截图的显示位置。类型：String</p>

<p><strong>responsive：</strong>是否在窗口尺寸改变的时候重置cropper。类型：Boolean，默认值true。</p>

<p><strong>checkImageOrigin：</strong>类型：Boolean，默认值true。默认情况下，插件会检测图片的源，如果是跨域图片，图片元素会被添加crossOriginclass，并会为图片的url添加一个时间戳来使getCroppedCanvas变为可用。添加时间戳会使图片重新加载，以使跨域图片能够使用getCroppedCanvas。在图片上添加crossOriginclass会阻止在图片url上添加时间戳，及图片的重新加载。</p>

<p><strong>background：</strong>类型：Boolean，默认值true。是否在容器上显示网格背景。 要想改背景，是直接改，cropper.css样式中的 cropper-bg。</p>

<p><strong>canvas（图片）相关</strong> <br>
<strong>movable：</strong>类型：Boolean，默认值true。是否允许移动图片 <br>
<strong>rotatable：</strong>类型：Boolean，默认值true。是否允许旋转图片。 <br>
<strong>scalable：</strong> 默认 true 。 是否允许扩展图片。（暂时不知道干嘛用） <br>
<strong>zoomable：</strong> 默认true, 石头允许缩放图片。 <br>
<strong>zoomOnWheel：</strong> 默认 true 是否允许鼠标滚轴 缩放图片 <br>
<strong>zoomOnTouch：</strong> 默认true 是否允许触摸缩放图片（触摸屏上两手指操作。） <br>
<strong>wheelZoomRatio：</strong> 默认0.1 师表滚轴缩放图片比例。即滚一下。图片缩放多少。如 0.1 就是图片的10%</p>

<p><strong>crop(裁剪框)相关</strong> <br>
<strong>aspectRatio</strong>裁剪框比例  默认NaN <br>
   例如：: 1 / 1,//裁剪框比例 1：1 <br>
<strong>modal</strong>：类型：Boolean，默认值true。是否在剪裁框上显示黑色的模态窗口。 <br>
<strong>cropBoxMovable</strong>:默认true ,是否允许拖动裁剪框 <br>
<strong>cropBoxResizable</strong>:默认 true,//是否允许拖动 改变裁剪框大小 <br>
<strong>autoCrop</strong>：类型：Boolean，默认值true。是否允许在初始化时自动出现裁剪框。 <br>
<strong>autoCropArea</strong>：类型：Number，默认值0.8（图片的80%）。0-1之间的数值，定义自动剪裁框的大小。 <br>
<strong>highlight</strong>：类型：Boolean，默认值true。是否在剪裁框上显示白色的模态窗口。 <br>
<strong>guides</strong>：类型：Boolean，默认值true。是否在剪裁框上显示虚线。 <br>
<strong>center</strong>:  默认true  是否显示裁剪框 中间的+ restore :  类型：Boolean，默认值true  是否 <br>
调整窗口大小后恢复裁剪区域。</p>

<p><strong>大小相关</strong> <br>
<strong>minContainerWidth</strong>：类型：Number，默认值200。容器的最小宽度。 <br>
<strong>minContainerHeight</strong>：类型：Number，默认值100。容器的最小高度。 <br>
<strong>minCanvasWidth</strong>：类型：Number，默认值0。canvas 的最小宽度（image wrapper）。 <br>
<strong>minCanvasHeight</strong>：类型：Number，默认值0。canvas 的最小高度（image wrapper）。</p>

<p><strong>监听触发的方法</strong> <br>
<strong>build</strong>：类型：Function，默认值null。build.cropper <br>
事件的简写方式。 ====== 。控件初始化前执行 <br>
<strong>built</strong>：类型：Function，默认值null。built.cropper <br>
事件的简写方式。  ====== 空间初始化完成后执行 <br>
<strong>dragstart</strong>：类型：Function，默认值null。dragstart.cropper <br>
事件的简写方式。 ======  拖动开始执行 <br>
<strong>dragmove</strong>：类型：Function，默认值null。dragmove.cropper <br>
事件的简写方式。======  拖动移动中执行 <br>
<strong>dragend</strong>：类型：Function，默认值null。dragend.cropper <br>
事件的简写方式。======  拖动结束执行 <br>
<strong>zoomin</strong>：类型：Function，默认值null。zoomin.cropper <br>
事件的简写方式。 ======  缩小执行 <br>
<strong>zoomout</strong>：类型：Function，默认值null。zoomout.cropper <br>
事件的简写方式。 ======  放大执行</p>



<h2 id="indexhtml代码如下">index.html代码如下：</h2>



<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-doctype">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span> <span class="hljs-attribute">lang</span>=<span class="hljs-value">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">charset</span>=<span class="hljs-value">"utf-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">link</span> <span class="hljs-attribute">rel</span>=<span class="hljs-value">"stylesheet"</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">link</span> <span class="hljs-attribute">rel</span>=<span class="hljs-value">"stylesheet"</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"css/cropper.css"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">link</span> <span class="hljs-attribute">rel</span>=<span class="hljs-value">"stylesheet"</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"css/main.css"</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;</span>
  <span class="hljs-comment">&lt;!--[if lt IE 9]&gt;
    &lt;script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"&gt;&lt;/script&gt;
  &lt;![endif]--&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
  <span class="hljs-comment">&lt;!--[if lt IE 8]&gt;
    &lt;p class="browserupgrade"&gt;You are using an &lt;strong&gt;outdated&lt;/strong&gt; browser. Please &lt;a href="http://browsehappy.com/"&gt;upgrade your browser&lt;/a&gt; to improve your experience.&lt;/p&gt;
  &lt;![endif]--&gt;</span>

  <span class="hljs-comment">&lt;!-- Content --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"container"</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">"margin-top:50px;"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"row"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"col-md-9"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- &lt;h3&gt;Demo:&lt;/h3&gt; --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"img-container"</span>&gt;</span>
          ![](images/picture.jpg)
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"col-md-3"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- &lt;h3&gt;Preview:&lt;/h3&gt; --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"docs-preview clearfix"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"img-preview preview-lg"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"row"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"col-md-9 docs-buttons"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- &lt;h3&gt;Toolbar:&lt;/h3&gt; --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary"</span> <span class="hljs-attribute">data-method</span>=<span class="hljs-value">"zoom"</span> <span class="hljs-attribute">data-option</span>=<span class="hljs-value">"0.1"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Zoom In"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"docs-tooltip"</span> <span class="hljs-attribute">data-toggle</span>=<span class="hljs-value">"tooltip"</span> <span class="hljs-attribute">data-animation</span>=<span class="hljs-value">"false"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"$().cropper("</span><span class="hljs-value">zoom",</span> <span class="hljs-attribute">0.1</span>)"&gt;</span>
              放大
            <span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary"</span> <span class="hljs-attribute">data-method</span>=<span class="hljs-value">"zoom"</span> <span class="hljs-attribute">data-option</span>=<span class="hljs-value">"-0.1"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Zoom Out"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"docs-tooltip"</span> <span class="hljs-attribute">data-toggle</span>=<span class="hljs-value">"tooltip"</span> <span class="hljs-attribute">data-animation</span>=<span class="hljs-value">"false"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"$().cropper("</span><span class="hljs-value">zoom",</span> <span class="hljs-attribute">-0.1</span>)"&gt;</span>
              缩小
            <span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary"</span> <span class="hljs-attribute">data-method</span>=<span class="hljs-value">"move"</span> <span class="hljs-attribute">data-option</span>=<span class="hljs-value">"-10"</span> <span class="hljs-attribute">data-second-option</span>=<span class="hljs-value">"0"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Move Left"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"docs-tooltip"</span> <span class="hljs-attribute">data-toggle</span>=<span class="hljs-value">"tooltip"</span> <span class="hljs-attribute">data-animation</span>=<span class="hljs-value">"false"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"$().cropper("</span><span class="hljs-value">move",</span> <span class="hljs-attribute">-10</span>, <span class="hljs-attribute">0</span>)"&gt;</span>
              左移
            <span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary"</span> <span class="hljs-attribute">data-method</span>=<span class="hljs-value">"move"</span> <span class="hljs-attribute">data-option</span>=<span class="hljs-value">"10"</span> <span class="hljs-attribute">data-second-option</span>=<span class="hljs-value">"0"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Move Right"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"docs-tooltip"</span> <span class="hljs-attribute">data-toggle</span>=<span class="hljs-value">"tooltip"</span> <span class="hljs-attribute">data-animation</span>=<span class="hljs-value">"false"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"$().cropper("</span><span class="hljs-value">move",</span> <span class="hljs-attribute">10</span>, <span class="hljs-attribute">0</span>)"&gt;</span>
              右移
            <span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary"</span> <span class="hljs-attribute">data-method</span>=<span class="hljs-value">"move"</span> <span class="hljs-attribute">data-option</span>=<span class="hljs-value">"0"</span> <span class="hljs-attribute">data-second-option</span>=<span class="hljs-value">"-10"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Move Up"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"docs-tooltip"</span> <span class="hljs-attribute">data-toggle</span>=<span class="hljs-value">"tooltip"</span> <span class="hljs-attribute">data-animation</span>=<span class="hljs-value">"false"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"$().cropper("</span><span class="hljs-value">move",</span> <span class="hljs-attribute">0</span>, <span class="hljs-attribute">-10</span>)"&gt;</span>
              上移
            <span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary"</span> <span class="hljs-attribute">data-method</span>=<span class="hljs-value">"move"</span> <span class="hljs-attribute">data-option</span>=<span class="hljs-value">"0"</span> <span class="hljs-attribute">data-second-option</span>=<span class="hljs-value">"10"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Move Down"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"docs-tooltip"</span> <span class="hljs-attribute">data-toggle</span>=<span class="hljs-value">"tooltip"</span> <span class="hljs-attribute">data-animation</span>=<span class="hljs-value">"false"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"$().cropper("</span><span class="hljs-value">move",</span> <span class="hljs-attribute">0</span>, <span class="hljs-attribute">10</span>)"&gt;</span>
              下移
            <span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary"</span> <span class="hljs-attribute">data-method</span>=<span class="hljs-value">"rotate"</span> <span class="hljs-attribute">data-option</span>=<span class="hljs-value">"-90"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Rotate Left"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"docs-tooltip"</span> <span class="hljs-attribute">data-toggle</span>=<span class="hljs-value">"tooltip"</span> <span class="hljs-attribute">data-animation</span>=<span class="hljs-value">"false"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"$().cropper("</span><span class="hljs-value">rotate",</span> <span class="hljs-attribute">-90</span>)"&gt;</span>
              左转90º
            <span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary"</span> <span class="hljs-attribute">data-method</span>=<span class="hljs-value">"rotate"</span> <span class="hljs-attribute">data-option</span>=<span class="hljs-value">"90"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Rotate Right"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"docs-tooltip"</span> <span class="hljs-attribute">data-toggle</span>=<span class="hljs-value">"tooltip"</span> <span class="hljs-attribute">data-animation</span>=<span class="hljs-value">"false"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"$().cropper("</span><span class="hljs-value">rotate",</span> <span class="hljs-attribute">90</span>)"&gt;</span>
              右转90º
            <span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary"</span> <span class="hljs-attribute">data-method</span>=<span class="hljs-value">"reset"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Reset"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"docs-tooltip"</span> <span class="hljs-attribute">data-toggle</span>=<span class="hljs-value">"tooltip"</span> <span class="hljs-attribute">data-animation</span>=<span class="hljs-value">"false"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"$().cropper("</span><span class="hljs-value">reset")"</span>&gt;</span>
              刷新
            <span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary btn-upload"</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">"inputImage"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Upload image file"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"file"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"sr-only"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"inputImage"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"file"</span> <span class="hljs-attribute">accept</span>=<span class="hljs-value">".jpg,.jpeg,.png,.gif,.bmp,.tiff"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"docs-tooltip"</span> <span class="hljs-attribute">data-toggle</span>=<span class="hljs-value">"tooltip"</span> <span class="hljs-attribute">data-animation</span>=<span class="hljs-value">"false"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Import image with Blob URLs"</span>&gt;</span>
              上传图片
            <span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn-group btn-group-crop"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary"</span> <span class="hljs-attribute">data-method</span>=<span class="hljs-value">"getCroppedCanvas"</span> <span class="hljs-attribute">data-option</span>=<span class="hljs-value">"{ "</span><span class="hljs-value">width":</span> <span class="hljs-attribute">180</span>, "<span class="hljs-attribute">height</span>"<span class="hljs-attribute">:</span> <span class="hljs-attribute">90</span> }" <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span>&gt;</span>
                上传头像
            <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Show the cropped image in modal --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"modal fade docs-cropped"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"getCroppedCanvasModal"</span> <span class="hljs-attribute">aria-hidden</span>=<span class="hljs-value">"true"</span> <span class="hljs-attribute">aria-labelledby</span>=<span class="hljs-value">"getCroppedCanvasTitle"</span> <span class="hljs-attribute">role</span>=<span class="hljs-value">"dialog"</span> <span class="hljs-attribute">tabindex</span>=<span class="hljs-value">"-1"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"modal-dialog"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"modal-content"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"modal-header"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">h5</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"modal-title"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"getCroppedCanvasTitle"</span>&gt;</span>Cropped<span class="hljs-tag">&lt;/<span class="hljs-title">h5</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"close"</span> <span class="hljs-attribute">data-dismiss</span>=<span class="hljs-value">"modal"</span> <span class="hljs-attribute">aria-label</span>=<span class="hljs-value">"Close"</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">aria-hidden</span>=<span class="hljs-value">"true"</span>&gt;</span>×<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"modal-body"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"modal-footer"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-secondary"</span> <span class="hljs-attribute">data-dismiss</span>=<span class="hljs-value">"modal"</span>&gt;</span>Close<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"download"</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"javascript:void(0);"</span> <span class="hljs-attribute">download</span>=<span class="hljs-value">"cropped.jpg"</span>&gt;</span>Download<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span><span class="hljs-comment">&lt;!-- /.modal --&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span><span class="hljs-comment">&lt;!-- /.docs-buttons --&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- Scripts --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"js/jquery.min.js"</span>&gt;</span><span class="javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"</span>&gt;</span><span class="javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"</span>&gt;</span><span class="javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"js/cropper.js"</span>&gt;</span><span class="javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"js/main.js"</span>&gt;</span><span class="javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
</code></pre>



<h2 id="cropperjs部分参数代码">cropper.js部分参数代码：</h2>



<pre class="prettyprint"><code class=" hljs javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(global, factory)</span> {</span>
  <span class="hljs-keyword">typeof</span> exports === <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> module !== <span class="hljs-string">'undefined'</span> ? factory(<span class="hljs-built_in">require</span>(<span class="hljs-string">'jquery'</span>)) :
  <span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd ? define([<span class="hljs-string">'jquery'</span>], factory) :
  (factory(global.$));
}(<span class="hljs-keyword">this</span>, (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($)</span> {</span> <span class="hljs-string">'use strict'</span>;

$ = <span class="hljs-string">'default'</span> <span class="hljs-keyword">in</span> $ ? $[<span class="hljs-string">'default'</span>] : $;

<span class="hljs-keyword">var</span> DEFAULTS = {
  <span class="hljs-comment">// Define the view mode of the cropper</span>
  viewMode: <span class="hljs-number">0</span>, <span class="hljs-comment">// 0, 1, 2, 3  显示</span>

  <span class="hljs-comment">// Define the dragging mode of the cropper</span>
  dragMode: <span class="hljs-string">'crop'</span>, <span class="hljs-comment">// 'crop', 'move' or 'none'</span>

  <span class="hljs-comment">// Define the aspect ratio of the crop box</span>
  aspectRatio: <span class="hljs-literal">NaN</span>,

  <span class="hljs-comment">// An object with the previous cropping result data</span>
  data: <span class="hljs-literal">null</span>,

  <span class="hljs-comment">// A selector for adding extra containers to preview</span>
  preview: <span class="hljs-string">''</span>,

  <span class="hljs-comment">// Re-render the cropper when resize the window</span>
  responsive: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Restore the cropped area after resize the window</span>
  restore: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Check if the current image is a cross-origin image</span>
  checkCrossOrigin: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Check the current image's Exif Orientation information</span>
  checkOrientation: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Show the black modal</span>
  modal: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Show the dashed lines for guiding</span>
  guides: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Show the center indicator for guiding</span>
  center: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Show the white modal to highlight the crop box</span>
  highlight: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Show the grid background</span>
  background: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Enable to crop the image automatically when initialize</span>
  autoCrop: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Define the percentage of automatic cropping area when initializes</span>
  autoCropArea: <span class="hljs-number">0.8</span>,

  <span class="hljs-comment">// Enable to move the image</span>
  movable: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Enable to rotate the image</span>
  rotatable: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Enable to scale the image</span>
  scalable: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Enable to zoom the image</span>
  zoomable: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Enable to zoom the image by dragging touch</span>
  zoomOnTouch: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Enable to zoom the image by wheeling mouse</span>
  zoomOnWheel: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Define zoom ratio when zoom the image by wheeling mouse</span>
  wheelZoomRatio: <span class="hljs-number">0.1</span>,

  <span class="hljs-comment">// Enable to move the crop box</span>
  cropBoxMovable: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Enable to resize the crop box</span>
  cropBoxResizable: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Toggle drag mode between "crop" and "move" when click twice on the cropper</span>
  toggleDragModeOnDblclick: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// Size limitation</span>
  minCanvasWidth: <span class="hljs-number">0</span>,
  minCanvasHeight: <span class="hljs-number">0</span>,
  minCropBoxWidth: <span class="hljs-number">0</span>,
  minCropBoxHeight: <span class="hljs-number">0</span>,
  minContainerWidth: <span class="hljs-number">200</span>,
  minContainerHeight: <span class="hljs-number">100</span>,

  <span class="hljs-comment">// Shortcuts of events</span>
  ready: <span class="hljs-literal">null</span>,
  cropstart: <span class="hljs-literal">null</span>,
  cropmove: <span class="hljs-literal">null</span>,
  cropend: <span class="hljs-literal">null</span>,
  crop: <span class="hljs-literal">null</span>,
  zoom: <span class="hljs-literal">null</span>
};</code></pre>



<h2 id="mainjs-代码如下">main.js 代码如下：</h2>



<pre class="prettyprint"><code class=" hljs javascript">$(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
<span class="hljs-pi">
  'use strict'</span>;<span class="hljs-comment">//表示强规则</span>

  <span class="hljs-keyword">var</span> console = window.console || { log: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>} };
  <span class="hljs-keyword">var</span> URL = window.URL || window.webkitURL;
  <span class="hljs-keyword">var</span> $image = $(<span class="hljs-string">'#image'</span>);
  <span class="hljs-keyword">var</span> $download = $(<span class="hljs-string">'#download'</span>);
  <span class="hljs-comment">//获取图片截取的位置</span>
  <span class="hljs-keyword">var</span> $dataX = $(<span class="hljs-string">'#dataX'</span>);
  <span class="hljs-keyword">var</span> $dataY = $(<span class="hljs-string">'#dataY'</span>);
  <span class="hljs-keyword">var</span> $dataHeight = $(<span class="hljs-string">'#dataHeight'</span>);
  <span class="hljs-keyword">var</span> $dataWidth = $(<span class="hljs-string">'#dataWidth'</span>);
  <span class="hljs-keyword">var</span> $dataRotate = $(<span class="hljs-string">'#dataRotate'</span>);
  <span class="hljs-keyword">var</span> $dataScaleX = $(<span class="hljs-string">'#dataScaleX'</span>);
  <span class="hljs-keyword">var</span> $dataScaleY = $(<span class="hljs-string">'#dataScaleY'</span>);
  <span class="hljs-keyword">var</span> options = {
        aspectRatio: <span class="hljs-number">1</span> / <span class="hljs-number">1</span>, <span class="hljs-comment">//裁剪框比例1:1</span>
        preview: <span class="hljs-string">'.img-preview'</span>,
        crop: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
          $dataX.val(<span class="hljs-built_in">Math</span>.round(e.x));
          $dataY.val(<span class="hljs-built_in">Math</span>.round(e.y));
          $dataHeight.val(<span class="hljs-built_in">Math</span>.round(e.height));
          $dataWidth.val(<span class="hljs-built_in">Math</span>.round(e.width));
          $dataRotate.val(e.rotate);
          $dataScaleX.val(e.scaleX);
          $dataScaleY.val(e.scaleY);
        }
      };
  <span class="hljs-keyword">var</span> originalImageURL = $image.attr(<span class="hljs-string">'src'</span>);
  <span class="hljs-keyword">var</span> uploadedImageURL;


  <span class="hljs-comment">// Tooltip</span>
  $(<span class="hljs-string">'[data-toggle="tooltip"]'</span>).tooltip();


  <span class="hljs-comment">// Cropper</span>
  $image.on({
    ready: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
      console.log(e.type);
    },
    cropstart: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
      console.log(e.type, e.action);
    },
    cropmove: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
      console.log(e.type, e.action);
    },
    cropend: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
      console.log(e.type, e.action);
    },
    crop: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
      console.log(e.type, e.x, e.y, e.width, e.height, e.rotate, e.scaleX, e.scaleY);
    },
    zoom: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
      console.log(e.type, e.ratio);
    }
  }).cropper(options);


  <span class="hljs-comment">// Buttons</span>
  <span class="hljs-keyword">if</span> (!$.isFunction(document.createElement(<span class="hljs-string">'canvas'</span>).getContext)) {
    $(<span class="hljs-string">'button[data-method="getCroppedCanvas"]'</span>).prop(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">true</span>);
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> document.createElement(<span class="hljs-string">'cropper'</span>).style.transition === <span class="hljs-string">'undefined'</span>) {
    $(<span class="hljs-string">'button[data-method="rotate"]'</span>).prop(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">true</span>);
    $(<span class="hljs-string">'button[data-method="scale"]'</span>).prop(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">true</span>);
  }


  <span class="hljs-comment">// Download</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> $download[<span class="hljs-number">0</span>].download === <span class="hljs-string">'undefined'</span>) {
    $download.addClass(<span class="hljs-string">'disabled'</span>);
  }


  <span class="hljs-comment">// Options</span>
  $(<span class="hljs-string">'.docs-toggles'</span>).on(<span class="hljs-string">'change'</span>, <span class="hljs-string">'input'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">var</span> $<span class="hljs-keyword">this</span> = $(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">var</span> name = $<span class="hljs-keyword">this</span>.attr(<span class="hljs-string">'name'</span>);
    <span class="hljs-keyword">var</span> type = $<span class="hljs-keyword">this</span>.prop(<span class="hljs-string">'type'</span>);
    <span class="hljs-keyword">var</span> cropBoxData;
    <span class="hljs-keyword">var</span> canvasData;

    <span class="hljs-keyword">if</span> (!$image.data(<span class="hljs-string">'cropper'</span>)) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'checkbox'</span>) {
      options[name] = $<span class="hljs-keyword">this</span>.prop(<span class="hljs-string">'checked'</span>);
      cropBoxData = $image.cropper(<span class="hljs-string">'getCropBoxData'</span>);
      canvasData = $image.cropper(<span class="hljs-string">'getCanvasData'</span>);

      options.ready = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
        $image.cropper(<span class="hljs-string">'setCropBoxData'</span>, cropBoxData);
        $image.cropper(<span class="hljs-string">'setCanvasData'</span>, canvasData);
      };
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'radio'</span>) {
      options[name] = $<span class="hljs-keyword">this</span>.val();
    }

    $image.cropper(<span class="hljs-string">'destroy'</span>).cropper(options);
  });


  <span class="hljs-comment">// Methods</span>
  <span class="hljs-comment">// 点击开始计算图片位置，获取位置</span>
  $(<span class="hljs-string">'.docs-buttons'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'[data-method]'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">var</span> $<span class="hljs-keyword">this</span> = $(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">var</span> data = $<span class="hljs-keyword">this</span>.data();
    <span class="hljs-keyword">var</span> $target;
    <span class="hljs-keyword">var</span> result;

    <span class="hljs-keyword">if</span> ($<span class="hljs-keyword">this</span>.prop(<span class="hljs-string">'disabled'</span>) || $<span class="hljs-keyword">this</span>.hasClass(<span class="hljs-string">'disabled'</span>)) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">if</span> ($image.data(<span class="hljs-string">'cropper'</span>) &amp;&amp; data.method) {
      data = $.extend({}, data); <span class="hljs-comment">// Clone a new one</span>

      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> data.target !== <span class="hljs-string">'undefined'</span>) {
        $target = $(data.target);

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> data.option === <span class="hljs-string">'undefined'</span>) {
          <span class="hljs-keyword">try</span> {
            data.option = <span class="hljs-built_in">JSON</span>.parse($target.val());
          } <span class="hljs-keyword">catch</span> (e) {
            console.log(e.message);
          }
        }
      }

      <span class="hljs-keyword">if</span> (data.method === <span class="hljs-string">'rotate'</span>) {
        $image.cropper(<span class="hljs-string">'clear'</span>);
      }

      result = $image.cropper(data.method, data.option, data.secondOption);

      <span class="hljs-keyword">if</span> (data.method === <span class="hljs-string">'rotate'</span>) {
        $image.cropper(<span class="hljs-string">'crop'</span>);
      }

      <span class="hljs-keyword">switch</span> (data.method) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'scaleX'</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">'scaleY'</span>:
          $(<span class="hljs-keyword">this</span>).data(<span class="hljs-string">'option'</span>, -data.option);
          <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> <span class="hljs-string">'getCroppedCanvas'</span>:
        <span class="hljs-comment">//上传头像</span>
          <span class="hljs-keyword">if</span> (result) {
            <span class="hljs-keyword">var</span> imgBase=result.toDataURL(<span class="hljs-string">'image/jpeg'</span>);
            <span class="hljs-keyword">var</span> data={imgBase:imgBase};
            $.post(<span class="hljs-string">'/docs/upload.php'</span>,data,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(ret)</span>{</span>
              <span class="hljs-keyword">if</span>(ret==<span class="hljs-string">'true'</span>){
                alert(<span class="hljs-string">'上传成功'</span>);
              }<span class="hljs-keyword">else</span>{
                alert(<span class="hljs-string">'上传失败'</span>);
              }
            },<span class="hljs-string">'text'</span>);
          }

          <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> <span class="hljs-string">'destroy'</span>:
          <span class="hljs-keyword">if</span> (uploadedImageURL) {
            URL.revokeObjectURL(uploadedImageURL);
            uploadedImageURL = <span class="hljs-string">''</span>;
            $image.attr(<span class="hljs-string">'src'</span>, originalImageURL);
          }

          <span class="hljs-keyword">break</span>;
      }

      <span class="hljs-keyword">if</span> ($.isPlainObject(result) &amp;&amp; $target) {
        <span class="hljs-keyword">try</span> {
          $target.val(<span class="hljs-built_in">JSON</span>.stringify(result));
        } <span class="hljs-keyword">catch</span> (e) {
          console.log(e.message);
        }
      }

    }
  });


  <span class="hljs-comment">// Keyboard</span>
  $(document.body).on(<span class="hljs-string">'keydown'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>

    <span class="hljs-keyword">if</span> (!$image.data(<span class="hljs-string">'cropper'</span>) || <span class="hljs-keyword">this</span>.scrollTop &gt; <span class="hljs-number">300</span>) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">switch</span> (e.which) {
      <span class="hljs-keyword">case</span> <span class="hljs-number">37</span>:
        e.preventDefault();
        $image.cropper(<span class="hljs-string">'move'</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-number">38</span>:
        e.preventDefault();
        $image.cropper(<span class="hljs-string">'move'</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>);
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-number">39</span>:
        e.preventDefault();
        $image.cropper(<span class="hljs-string">'move'</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-number">40</span>:
        e.preventDefault();
        $image.cropper(<span class="hljs-string">'move'</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
        <span class="hljs-keyword">break</span>;
    }

  });


  <span class="hljs-comment">// Import image</span>
  <span class="hljs-keyword">var</span> $inputImage = $(<span class="hljs-string">'#inputImage'</span>);

  <span class="hljs-keyword">if</span> (URL) {
    $inputImage.change(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
      <span class="hljs-keyword">var</span> files = <span class="hljs-keyword">this</span>.files;
      <span class="hljs-keyword">var</span> file;

      <span class="hljs-keyword">if</span> (!$image.data(<span class="hljs-string">'cropper'</span>)) {
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-keyword">if</span> (files &amp;&amp; files.length) {
        file = files[<span class="hljs-number">0</span>];

        <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^image\/\w+$/</span>.test(file.type)) {
          <span class="hljs-keyword">if</span> (uploadedImageURL) {
            URL.revokeObjectURL(uploadedImageURL);
          }

          uploadedImageURL = URL.createObjectURL(file);
          $image.cropper(<span class="hljs-string">'destroy'</span>).attr(<span class="hljs-string">'src'</span>, uploadedImageURL).cropper(options);
          $inputImage.val(<span class="hljs-string">''</span>);
        } <span class="hljs-keyword">else</span> {
          window.alert(<span class="hljs-string">'Please choose an image file.'</span>);
        }
      }
    });
  } <span class="hljs-keyword">else</span> {
    $inputImage.prop(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">true</span>).parent().addClass(<span class="hljs-string">'disabled'</span>);
  }

});</code></pre>

<p>使用canvas生成的截图转换生成base64代码。 <br>
后台处理base64代码片段（PHP服务端）。</p>



<h2 id="uploadphp代码如下">upload.php代码如下：</h2>



<pre class="prettyprint"><code class=" hljs xml"><span class="php"><span class="hljs-preprocessor">&lt;?php</span>
    error_reporting(<span class="hljs-number">0</span>);<span class="hljs-comment">//禁用错误报告  </span>
    <span class="hljs-keyword">if</span> (IS_POST) {

        header(<span class="hljs-string">'Content-type:text/html;charset=utf-8'</span>);
        <span class="hljs-variable">$base64_image_content</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">'imgBase'</span>];


        <span class="hljs-comment">//将base64编码转换为图片保存</span>
        <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">'/^(data:\s*image\/(\w+);base64,)/'</span>, <span class="hljs-variable">$base64_image_content</span>, <span class="hljs-variable">$result</span>)) {
            <span class="hljs-variable">$type</span> = <span class="hljs-variable">$result</span>[<span class="hljs-number">2</span>];
            <span class="hljs-variable">$new_file</span> = <span class="hljs-string">"./uploads/"</span>;
            <span class="hljs-keyword">if</span> (!file_exists(<span class="hljs-variable">$new_file</span>)) {
                <span class="hljs-comment">//检查是否有该文件夹，如果没有就创建，并给予最高权限</span>
                mkdir(<span class="hljs-variable">$new_file</span>, <span class="hljs-number">0700</span>);
            }
            <span class="hljs-variable">$img</span>=time() . <span class="hljs-string">".{$type}"</span>;
            <span class="hljs-variable">$new_file</span> = <span class="hljs-variable">$new_file</span> . <span class="hljs-variable">$img</span>;
            <span class="hljs-comment">//将图片保存到指定的位置</span>
            <span class="hljs-keyword">if</span> (file_put_contents(<span class="hljs-variable">$new_file</span>, base64_decode(str_replace(<span class="hljs-variable">$result</span>[<span class="hljs-number">1</span>], <span class="hljs-string">''</span>, <span class="hljs-variable">$base64_image_content</span>)))) {
                <span class="hljs-keyword">echo</span> <span class="hljs-string">'true'</span>;
            }<span class="hljs-keyword">else</span>{
                <span class="hljs-keyword">echo</span> <span class="hljs-string">'false'</span>;
            }
        }<span class="hljs-keyword">else</span>{
            <span class="hljs-keyword">echo</span> <span class="hljs-string">'false'</span>;
        }

    }


<span class="hljs-preprocessor">?&gt;</span></span></code></pre>

<p>实现效果：</p>

<p><img src="http://upload-images.jianshu.io/upload_images/6673460-dc4841b2330ed932.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title="" class="img-responsive"></p>

<p>选择要截取的图片位置，按“上传头像”按钮，截取的图片就上传并保存到服务器本站点目录的uploads文件夹中。</p>
								</div>
								<div class="col-lg-4 animate-box">
									<div class="gtco-highlight right">
										<h4>点点滴滴</h4>
										<p style="font-size:15px;">每個人心裡就像是一面湖水 
不同的是 有的是活水 有的是死水  
而思想 則是水的源頭 
有無思想 也是決定活死水的根源 

若時光 
在我們懂得那麼多道理的情況下
仍然沒能讓我們變得更加從容
只能說明辜負了歲月的營養

知行合一 
知 並非只是知道 而是良知
行 並非只是行為 而是行動
知行合一 從容不迫</p>
									</div>
								</div>
							</div>
													
						</div>
					</article>
				</div>
			</div>
		</div>
	</div>



	<footer id="gtco-footer" role="contentinfo" style="padding:0;">
		<div class="container">
			<div class="row copyright">
				<div class="col-md-12 text-center">
					<p>
						<span style="font-size:16px;">©</span>2017 版权所有 ICP证：<a href="http://www.miitbeian.gov.cn/" target="_block" style="color:#666666">粤ICP备17112246号</a>
					</p>
				</div>
			</div>

		</div>
	</footer>
	</div>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
	</div>
	
	<!-- jQuery -->
	<script src="../../js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="../../js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="../../js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="../../js/jquery.waypoints.min.js"></script>
	<!-- Stellar -->
	<script src="../../js/jquery.stellar.min.js"></script>
	<!-- Main -->
	<script src="../../js/main.js"></script>

	</body>
</html>

